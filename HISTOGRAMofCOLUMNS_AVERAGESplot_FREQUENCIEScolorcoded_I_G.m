

function    HISTOGRAMofCOLUMNS_AVERAGESplot_FREQUENCIEScolorcoded_I_G                                                                                                                                                                                       (...
            input, filename                                                                                                                                                                                                                                   )   
%%  Description                                                                                                                                                                                            



%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%   
%   Inputs                                                                                                                                                                                     %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

%       A matrix


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%   Outputs                                                                                                                                                                                    %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

%       A histogram plot with:
%
%               - the x-axis as column number
%               - the y-axis as the values of the entries
%               - each point represents a unique entry in its column, and the color represents the
%                 values relative frequency
%               - a line plot of each column's average value (scaled to fit)
%
%       along with a textbox containing:
%      
%               - the min, max, and mean of the sample variances calculated for each column
%               - the maximum measure of the range for any one column
%
%       saved to input file name.
%
%
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%   Description                                                                                                                                                                                %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

%       Just as above.  To change the output to a displayed figure, choose the option in the 'Creating
%       the figure...' section and comment out the saving at the end.

%%  Common Scripts                                                                                                                                                                                         


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Calculations                                                                                                                                                                              %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Average Value (of matrix):              mean(mean(M))

%   Average Value (of matrix's columns):    mean(M)

%   Average Value (of matrix's rows):       mean(M')'

%   Average Value                           mean(M,n)
%   (of matrix along dimension n):



%   Max Value (of matrix):                  max(max(M))

%   Max Value (of matrix's columns):        max(M)

%   Max Value (of matrix's rows):           max(M')'



%   Min Value (of matrix):                  min(min(M))

%   Min Value (of matrix's columns):        min(M)

%   Min Value (of matrix's rows):           min(M')'


%   Norm (of vector):                       norm(v)


%   Pointwise calculations:                 v.*v', v.^2, ...


%   Variance (of matrix's columns):         var(M)



%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Colors                                                                                                                                                                                    %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Color to vector converter:              uisetcolor


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Conversions                                                                                                                                                                               %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Cell to Matrix:                         cell2mat(C)


%   Number to String:                       num2str(5) 


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%   Evaluating                                                                                                                                                                                 %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Program as Argument                     feval(<program>,<program inputs>)


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%   Exporting                                                                                                                                                                                  %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Matrix to .CSV:                         dlmwrite(filename,input,'precision',15);


%   Table to .TXT (comma separated)         writetable(input_table,'output location');


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%   Importing                                                                                                                                                                                  %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   To Cell:                                readcell(<file location>,'Range','A4:C10');
%   To Matrix:                              readmatrix(<file location>,'Range',[<starting row> <starting column>]);
%   To Table:                               readcell(<file location>,'Range','B4');


%   Directory to Structure:                 dir(['directory location\' '*.txt']);


%   Excel File to Cell Array:               [~,~,output]=xlsread(input);


%   .TXT to Table:                          readtable(input)  


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%   Searching                                                                                                                                                                                  %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Condition as an index:                  x(x<=0)=inf     


%   Indices and values satisfying           [row,column,value_when_evaluated]=find(losses==min(losses))
%   a condition


%   Is an element a member:                 ismember(<element>,<set>)


%   Unique Elements of Matrix:              [unique_elements, lowest_index_of_occurence,unique_indices]=unique(M)


%   Unique Elements, Number of Occurences:  accumarray(unique_indices,1)    


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%   Strings                                                                                                                                                                                    %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Does it Contain:                        contains(<string>,<substring>)


%   Divide in Two:                          [before,remainder] = strtok(<string>,<delimater>)


%   Divide into Portions:                   split(<string>,<delimiter>)   


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%   System commands                                                                                                                                                                            %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


%   Copyfile:                               copyfile('original location','new location','f')


%   Make directory:                         mkdir([output '\<folder name>']);


%   Movefile:                               movefile('original location','new location','f')


%   Shut down:                              system('shutdown -s')





%%  Calculating statistics                                                                                                                                                                                 


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Dimensions of the input matrix                                                                                                                                                            %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

number_of_rows=length(input(:,1));
number_of_columns=length(input(1,:));


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Average, sample variance, and the measure of the range of each column                                                                                                                     %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

averages=mean(input);
    
sample_variance=var(input);

measure_of_range=max(max(input)-min(input));


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Each column's unique entries and their relative frequencies                                                                                                                               %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

histogram_plot_data=RELATIVEfrequencies_column_M_M(input);

clear input


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Convert this information for input into Matlab's Scatter function:                                                                                                                        %
%                                                                                                                                                                                              %
%       -Assign unique values to the vector <values>                                                                                                                                           %
%       -Assign the column of occurence to the corresponding entry of the vector <columns>                                                                                                     %
%       -Assign the relative frequency to the corresponding entry of the vector ,<relative_frequencies>                                                                                        %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%


values=[];columns=[];relative_frequencies=[];

for i=1:length(histogram_plot_data(1,:,1))
    
    for j=1:length(histogram_plot_data(:,1,1))
        
        if histogram_plot_data(j,i,2)~=0
            values(end+1)=histogram_plot_data(j,i,1);
            columns(end+1)=i;
            relative_frequencies(end+1)=histogram_plot_data(j,i,2);
        end

    end
    
end

clear histogram_plot_data


%%  Creating the figure and setting the image size                                                                                                                                                         



%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Create a figure                                                                                                                                                                           %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

graph = figure('InvertHardcopy','off','Visible','off','Colormap',CM_19_08_18_01,'Color',[1 1 1]);
                 
             
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Set the image size                                                                                                                                                                        %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
            
set(gcf,'PaperUnits','inches','PaperPosition',[0 0 20.5 8]);


%%  Create the histogram axes and plot                                                                                                                                                                     


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    The axes, set font and position                                                                                                                                                           %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

axes_histogram = axes('Parent',graph,'FontName','Palatino Linotype','FontSize',12,'Position',...
                      [0.0483267479549314 0.10387323943662 0.794162613747196 0.805281690140842]);
                                 

%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    The plot                                                                                                                                                                                  %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

point_size=1500;

scatter(columns,values,point_size,relative_frequencies,'Marker','.')


%%  Set histogram axes properties and hold                                                                                                                                                                 

%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Bounds                                                                                                                                                                                    %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

xlim(axes_histogram,[0 number_of_columns+1]);


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  find the order of magnitude used on the y-axis                                                                                                                                   %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

y_ticks = axes_histogram.YTick;

minimum_order_of_magnitude=0;

for i=-10:10
    if y_ticks(1,2)/10^i>=1 && y_ticks(1,2)/10^(i+1)<=1
        minimum_order_of_magnitude=i;
        break
    end
end



%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  set the scientific exponent to zero but keep the tick labeling                                                                                                                   %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

if ~minimum_order_of_magnitude==0
    
    axes_histogram.YRuler.Exponent = 0;

    axes_histogram.YTickLabel=cellstr(num2str(y_ticks(:)/10^minimum_order_of_magnitude));
    
end


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  label the axes                                                                                                                                                                   %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

axes_histogram_x_label=xlabel('Time','FontWeight','bold','FontSize',16,'FontName','Palatino Linotype');


if minimum_order_of_magnitude==-1 
    
    axes_histogram_y_label=ylabel({'Intensity \times 10'},...
        'FontWeight','bold','FontSize',16,'FontName','Palatino Linotype');


elseif ~minimum_order_of_magnitude==0 
    
    axes_histogram_y_label=ylabel({strcat('Intensity \times 10^{',num2str(-minimum_order_of_magnitude),'}')},...
        'FontWeight','bold','FontSize',16,'FontName','Palatino Linotype');
           
       
else
    
    axes_histogram_y_label=ylabel({'Intensity'},'FontWeight','bold','FontSize',16,'FontName','Palatino Linotype');
    
end
        

%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels: Positions                                                                                                                                                                         %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

set(axes_histogram_x_label, 'Units', 'Normalized', 'Position', [0.5, -0.07, 0]);


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Ticks facing out                                                                                                                                                                          %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

axes_histogram.XAxis.TickDirection='out';
axes_histogram.YAxis.TickDirection='out';


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Hold axes                                                                                                                                                                                 %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

hold(axes_histogram,'on'); 


%%  Set average intensity axes properties and hold                                                                                                                                                         


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    The axes, set font and position                                                                                                                                                           %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

axes_averages = axes('Position',get(axes_histogram, 'Position'),'XAxisLocation','top','YAxisLocation',...
       'right','Color','none','XColor','[1 1 1]','YColor',[0.97 0.73 0.27],'FontName','Palatino Linotype');
       
       
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Bounds                                                                                                                                                                                    %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
   
xlim(axes_averages,[0 number_of_columns+1]); 


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  place the y-axis tick marks                                                                                                                                                      %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

set(axes_averages,'ytick',linspace(min(averages),max(averages),3))


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  find the order of magnitude used on the y-axis                                                                                                                                   %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

y_ticks = axes_averages.YTick;

minimum_order_of_magnitude=0;

for i=-10:10
    if y_ticks(1,2)/10^i>=1 && y_ticks(1,2)/10^(i+1)<=1
        minimum_order_of_magnitude=i;
        break
    end
end


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  set the scientific exponent to zero but keep the tick labeling                                                                                                                   %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

if ~minimum_order_of_magnitude==0
    
    axes_averages.YRuler.Exponent = 0;

    axes_averages.YTickLabel=cellstr(num2str(y_ticks(:)/10^minimum_order_of_magnitude));
    
end


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels:  label the y-axis axes                                                                                                                                                            %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

if minimum_order_of_magnitude==-1 

    y=ylabel({'Spatially Averaged Intensity \times 10'},'FontWeight','bold',...
           'FontSize',16,'FontName','Palatino Linotype','Rotation',270,'Color',[0.97 0.73 0.27]);

elseif ~minimum_order_of_magnitude==0 

    y=ylabel({strcat('Spatially Averaged Intensity \times 10^{',num2str(-i),'}')},'FontWeight','bold',...
           'FontSize',16,'FontName','Palatino Linotype','Rotation',270,'Color',[0.97 0.73 0.27]);
       
else      
    
    y=ylabel({'Spatially Averaged Intensity'},'FontWeight','bold',...
           'FontSize',16,'FontName','Palatino Linotype','Rotation',270,'Color',[0.97 0.73 0.27]);
       
end
 

%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Labels: Positions                                                                                                                                                                         %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

set(y, 'Units', 'Normalized', 'Position', [1.065, 0.5, 0]);


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Ticks                                                                                                                                                                                     %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

axes_averages.YAxis.TickLabelFormat='%,.2f';
axes_averages.YAxis.TickDirection='out';


%%  Link the x-axes and put a hold on, then plot the average intensities                                                                                                                                   


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Link the axes and put the hold on                                                                                                                                                         %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

linkaxes([axes_histogram axes_averages],'x');

hold on


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Plot the averages                                                                                                                                                                         %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

plot(averages,'Parent',axes_averages,'Color',[0.97 0.73 0.27],'LineWidth', 2);


%%  The color bar, text box containing statistics, and the title                                                                                                                                           


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    The color bar                                                                                                                                                                             %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

cbar=colorbar('peer',axes_histogram,...
    'position',[0.915690027631546 .12 .015 .4]);

cbar.TickLabels=[1 2 3 4 5 6 7 8 9 10];


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    The text box                                                                                                                                                                              %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

annotation(graph,'textbox',...
    [0.908690027631546 0.610428934530504 0.19497098444436 0.283215374503552],...
    'String',{['S^{2}_{max}:   ' sprintf('%.5f',max(sample_variance))],'',...
    ['S^{2}_{min}:   ' sprintf('%.5f',min(sample_variance))],'',...
    ['S^{2}_{avg}:   ' sprintf('%.5f',mean(sample_variance))],'',...
    ['Range_{max}:   ' sprintf('%.5f',measure_of_range)],'',...
    ['N:   ' int2str(number_of_rows)]},...
    'FontSize',12,...
    'FontName','Palatino Linotype',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    The title                                                                                                                                                                                 %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

% title({'Histogram'},'HorizontalAlignment','center','FontWeight','bold',...
%     'FontSize',30,...
%     'FontName','Palatino Linotype');


%%  Saving the figure and clearing the memory                                                                                                                                                              


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Save the figure (saving as .jpg produces severe RAM spikes)                                                                                                                               %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

print(graph,'-dbmp',[filename '.bmp'] , '-r400');

%print(graph,'-djpeg',[filename '.jpg'] , '-r600');

%saveas(graph, [filename '.jpg']);

%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------% 
%    Clear and close the current figure (very necessary; the effects of these commands are sensitive to their placement)                                                                       %  
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

clf
close(gcf)


end